/*! BUILD: 2015-07-17 */
Common.LoadBranchName=function(a){var b=function(){var a=c("txt_addaccforbankname_1687"),b=c("#txt_addaccforbank_1664"),d=c("load_branch_name_info"),e=c("show_bank_name"),f=d.find("#query_branch_name_input"),g=function(a,b,c,d,e,f){var h=this,j={canvas:d,callbackFn:function(e){Common.LightBox.show(),Common.request(b.findPageIndex(e),function(f){c.html(a,{list:f.list},function(){g(a,b,c,d,f.recordnumber,e),Common.LightBox.hide(),$("#page_footer").find(".p-list").last().hide().prev().hide(),$("#show_bank_name ul.bank-box02 li").bind("click",function(a){i(a)})})},function(){Common.LightBox.hide()})},pageIndex:f,point:h,recordCount:e,pageSize:b.attributes.params.pageSize,showDownload:!1},k=Pager.getInstance();k.init(j),$(d)[e>0?"show":"hide"]()},h=function(){$(document).on("mousedown",function(b){var c=$(b);c.closest("#txt_addaccforbankname_1687")||c.closest("#load_branch_name_info")||(d.hide(),a.addClass("bank-close"),$(document).off("mousedown"))})},i=function(c){var e=$(c).attr("bankName"),f=a.attr("bankname");e!=f&&$("#saveAsPayee").size()&&$("#saveAsPayee").attr("disabled",!1).attr("checked",!0),a.removeAttr("lan").attr({bankName:e,title:e}).text(e),b.attr("payeecnaps",$(c).attr("payeecnaps")),d.hide(),a.addClass("bank-close"),$(document).off("mousedown")},j=function(b,c){var f={toBankCode:b,bankName:c,currentIndex:"0",pageSize:"10"},h=new Model("PsnTransQueryExternalBankInfo",f);Common.LightBox.show(),Common.request(h,function(b){var c="templates/common/showAccountName.ejs",f=b.list;e.html(c,{list:f},function(){a.removeClass("bank-close"),d.show(),Common.LightBox.hide(),CU.changeLan(d),f&&f.length&&(g(c,h,e,"#page_footer",b.recordnumber,1),$("#page_footer").find(".p-list").last().hide().prev().hide(),$("#show_bank_name ul.bank-box02 li").bind("click",function(a){i(a)}))})},function(){Common.LightBox.hide()})};a.on("click",function(){var c=b.attr("toBankCode");return c?a.hasClass("bank-close")?(f.val(""),j(c,""),void h()):!1:(Common.LightBox.showMessage(CU.getDictNameByKey("l87915")),!1)}),d.find("#queryBtn").on("click",function(){if(!formValid.checkAll(d))return!1;var a=b.attr("toBankCode"),c=f.val().trim(),e=c.indexOf("银行");-1!=e&&e+2!=c.length&&(c=c.substr(0,e+2)+" "+c.substr(e+2).trim(),f.val(c)),j(a,c)}),f.on("keyup",function(){var a=event.keyCode;13==a&&d.find("#queryBtn").trigger("click")})},c=function(b){return a.find("#"+b)};c("load_branch_name_info").html("templates/common/loadBranch.ejs",{},function(){CU.changeLan(c("load_branch_name_info")),b()}),Model.prototype.findPageIndex=function(a,b){return this.attributes.params._refresh=b?"true":"false",this.attributes.params.currentIndex=(a-1)*this.attributes.params.pageSize+"",this}},Common.LoadBankName=function(a){var b=function(){var a=this,b={},e=!0,f=function(){$(document).on("mousedown",function(a){var b=$(a);b.closest("#choose_bank_account")||b.closest("#txt_addaccforbank_1664")||(i.hide(),j.addClass("bank-close"),$(document).off("mousedown"))})},g=function(a){var b=r.find("li");if(a)if(b.find("div").children("span:contains('"+a+"')").size()){r.addClass("ck-box"),b.hide().find("div span").hide().parent().children("span:contains('"+a+"')").show().parent().parent().show();var c=b.find("div").children("span:contains('"+a+"')").parent().prev("span");$.each(q.find("li").show().find("a"),function(a,b){var d=$(b).text(),e=!0;$.each(c,function(a,b){$(b).text()==d&&(e=!1)}),e&&$(b).parent().hide()}),$("#append_more_a").find(".ck-list:visible a").eq(0).trigger("click"),q.show()}else r.removeClass("ck-box"),b.hide().last().show(),q.hide();else r.addClass("ck-box"),q.show().find("li").show(),b.find("div span").show(),b.hide().filter(function(a){return"no_query_data"!=a.id}).show(),$(".ck-list a").eq(0).trigger("click")},h=function(a){var b='<li class="banklogo"><img src="images/bank_',e='"/></li>',g="";$.each(a,function(a,c){g+=b+c.imageName+'.png" alt="'+c.bankName+'" toBankCode="'+c.toBankCode+'" titlan="'+c.titlan+'" bankName="'+c.bankName+'" payeecnaps="'+c.bankCode+e}),$(g).appendTo(o.html("")),CU.changeLan(o),o.on("click","img",function(a){var b=$(a).attr("toBankCode"),e=$(a).attr("bankName"),f=j.attr("toBankCode");b!=f&&($("#saveAsPayee").size()&&$("#saveAsPayee").attr("disabled",!1).attr("checked",!0),c("txt_addaccforbankname_1687").attr({lan:"l90096",bankName:""}).text(""),CU.changeLan(c("txt_addaccforbankname_1687").parent())),j.removeAttr("lan").attr({toBankCode:"0"==d()?b:"",bankName:e,title:e,payeecnaps:$(a).attr("payeecnaps")}).text(e).addClass("bank-close"),i.hide(),$(document).off("mousedown")}),j.removeClass("bank-close"),k.addClass("active-c"),p.hide(),o.show(),m.hide(),l.removeClass()["0"==d()?"hide":"show"](),i.show(),f()},i=c("choose_bank_account"),j=c("txt_addaccforbank_1664"),k=c("li_usual_bank"),l=c("li_more_bank"),m=c("search_bank"),n=c("search_bank_input"),o=c("ul_usual_bankInfo"),p=c("div_more_bankInfo"),q=c("append_more_a"),r=c("append_more_bank");k.on("click",function(a){return $(a).hasClass("active-c")?!1:($(a).addClass("active-c"),l.removeClass(),o.show(),p.hide(),void m.hide())}),l.on("click",function(a){if($(a).hasClass("active-c"))return!1;if($(a).addClass("active-c"),k.removeClass(),n.val("").removeClass("warning"),e){for(var c="",d="",f=97;122>=f;f++){var h=String.fromCharCode(f-32);d="A"==h?' class="ck-active"':"",c+='<li class="ck-list"><a href="javascript:void(0);"'+d+">"+h+"</a></li>",b[h]=new Common.Hashtable}$(c).appendTo(q),q.find("a").on("click",function(a){if("ck-active"==this.className)return!1;var b=$(a).text(),c=$("#tips_"+b).offset().top;c=$.browser.msie&&$.browser.version<8?c:c-69,r.get(0).scrollTop=c,$(".ck-list a[class=ck-active]").removeClass(),this.className="ck-active",$("li[id*=tips_]").children("span[class=item-title]").removeClass().addClass("fl10"),$("li[id=tips_"+$(a).text()+"]").children("span[class=fl10]").removeClass().addClass("item-title")}),Common.LightBox.show(),Common.request(new Model("PsnOtherBankQueryForTransToAccount",{type:"OTHER",bankName:""}),function(a){$.each(a.accountOfBankList,function(a,c){for(var d=getGB2312Spell(c.bankName.substr(0,1)),e=d.substr(0,1),f=97;122>=f;f++){var g=String.fromCharCode(f);e==g&&b[g.toUpperCase()].add(c.bankName,c)}});var c="",d="",f="</div></li>",g="";$.each(b,function(a,b){var e="A"==a?"item-title":"fl10";c='<li class="clearfix" id="tips_'+a+'"><span class="'+e+'">'+a+'</span><div class="item-con">',b&&b.length&&$.each(b._hash,function(a,b){d+="<span class='bankAccount' payeeBankName='"+b.bankName+"' payeecnaps='"+b.bankCode+"'>"+a+"</span>"}),g+=c+d+f,d=""}),g+='<li class="clearfix hide tac text-red" style="margin-top:63px;margin-bottom:47px;" id="no_query_data" lan="l9960" v="没有符合条件的查询记录！"></li>',$(g).appendTo(r),r.find(".bankAccount").on("click",function(a){var b=$(a).attr("payeeBankName");j.removeAttr("lan").attr({toBankCode:"",payeecnaps:$(a).attr("payeecnaps"),title:b,bankName:b}).text(b).addClass("bank-close"),i.hide(),$(document).off("mousedown")}),CU.changeLan(r),e=!1,Common.LightBox.hide(),o.hide(),p.show(),m.show()},function(){Common.LightBox.hide()})}else o.hide(),g(""),p.show(),m.show()}),j.on("click",function(){return j.hasClass("bank-close")?void("0"==d()?h(Common.usualBankList):a.accList&&a.accList.length?h(a.accList):(a.accList=[],Common.LightBox.show(),Common.request(new Model("PsnOtherBankQueryForTransToAccount",{type:"HOT",bankName:""}),function(b){$.each(b.accountOfBankList,function(b,c){for(var d=0,e=Common.usualBankList.length;e>d;d++)if(c.bankName==Common.usualBankList[d].bankName){a.accList[a.accList.length]=$.extend([],Common.usualBankList[d],c);break}}),h(a.accList),Common.LightBox.hide()},function(){Common.LightBox.hide()}))):!1});var s="",t="";n.on("focus",function(){s=n.val().trim(),a.timeFresh=setInterval(function(){return t=n.val().trim(),console.log("secondValue:"+t),formValid.checkAll(m)?void((s!==t||""==t||t==n.attr("placeHolder"))&&(s=t,t==n.attr("placeHolder")&&(t=""),g(t))):!1},200)}).on("blur",function(){clearInterval(a.timeFresh)})},c=function(b){return a.find("#"+b)},d=function(){var a=c("[name=rd_trans_mode_1015]:checked").get(0),b="";try{b=a&&a.value}catch(d){b="1"}return b};c("choose_bank_account").html("templates/common/loadBank.ejs",{},function(){CU.changeLan(c("choose_bank_account")),b()})},Common.usualBankList=[{bankName:"中国工商银行",toBankCode:"102",bankCode:"",titlan:"l1279",imageName:"gs"},{bankName:"中国农业银行股份有限公司",toBankCode:"103",bankCode:"",titlan:"l1283",imageName:"ny"},{bankName:"中国建设银行股份有限公司总行",toBankCode:"105",bankCode:"",titlan:"l1280",imageName:"js"},{bankName:"交通银行",toBankCode:"301",bankCode:"",titlan:"l1290",imageName:"jt"},{bankName:"招商银行股份有限公司",toBankCode:"308",bankCode:"",titlan:"l1284",imageName:"zs"},{bankName:"中国邮政储蓄银行有限责任公司",toBankCode:"403",bankCode:"",titlan:"l1291",imageName:"yz"},{bankName:"中国民生银行",toBankCode:"305",bankCode:"",titlan:"l1295",imageName:"ms"},{bankName:"兴业银行总行",toBankCode:"309",bankCode:"",titlan:"l1298",imageName:"xy"},{bankName:"中信银行股份有限公司",toBankCode:"302",bankCode:"",titlan:"l1292",imageName:"zx"},{bankName:"上海浦东发展银行",toBankCode:"310",bankCode:"",titlan:"l1299",imageName:"pf"},{bankName:"中国光大银行",toBankCode:"303",bankCode:"",titlan:"l1293",imageName:"gd"},{bankName:"平安银行（原深圳发展银行）",toBankCode:"307",bankCode:"",titlan:"l1297",imageName:"pa"},{bankName:"华夏银行股份有限公司总行",toBankCode:"304",bankCode:"",titlan:"l1294",imageName:"hx"},{bankName:"广发银行股份有限公司",toBankCode:"306",bankCode:"",titlan:"l1296",imageName:"gf"},{bankName:"国家开发银行",toBankCode:"201",bankCode:"",titlan:"l1285",imageName:"gjkf"},{bankName:"中国进出口银行",toBankCode:"202",bankCode:"",titlan:"l1287",imageName:"jck"},{bankName:"中国农业发展银行",toBankCode:"203",bankCode:"",titlan:"l1289",imageName:"nyfz"},{bankName:"其他银行",toBankCode:"OTHER",bankCode:"",titlan:"l1301",imageName:"other"}];