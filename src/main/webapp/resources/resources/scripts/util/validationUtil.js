/*! BUILD: 2015-05-19 */
Common.ValicationUtil=Common.VU={addAmountValid:function(a,b,c){switch(a){case"027":c&&"12"==c?$(b).attr({tips:"tipsrequired tipsmax tips0528",validateGroup:"{required:true,maxLength:12,reg132:true}"}).attr("currCode",a):$(b).attr({tips:"tipsrequired tipsmax tips0306",validateGroup:"{required:true,maxLength:15,reg100:true}"}).attr("currCode",a);break;case"034":$(b).attr({tips:"tipsrequired tipsmax tips0257",validateGroup:"{required:true,maxLength:15,reg44:true}"});break;default:c&&"12"==c?$(b).attr({tips:"tipsrequired tipsmax tips0293",validateGroup:"{required:true,maxLength:15,reg87:true}"}).attr("currCode",a):$(b).attr({tips:"tipsrequired tipsmax tips0293",validateGroup:"{required:true,maxLength:15,reg45:true}"}).attr("currCode",a)}},validateExecutePeriod:function(a,b,c,d,e,f){var g=a.find("[name="+b+"]:checked").val(),h="";if(1==g){var i=a.find("#"+d).val();0==CU.Date.diff(c,i)&&(h+=Regional.l8515[lan]+" "),CU.Date.diff(c,i)<0&&(h+=Regional.l8515[lan]+" "),CU.Date.inThreeMonth(c,i)||(h+=Regional.l0122[lan]+" ")}if(2==g){var j=a.find("#"+e).val(),k=a.find("#"+f).val();CU.Date.diff(c,j)<0&&(h+=Regional.l8516[lan]+" "),CU.Date.diff(c,k)<0&&(h+=Regional.l8517[lan]+" "),CU.Date.diff(j,k)<0&&(h+=Regional.l6882[lan]+" "),CU.Date.inOneMonth(c,j)||(h+=Regional.l8116[lan]+" "),CU.Date.inSixMonth(c,k)||(h+=Regional.l8117[lan]+" ")}return h},validateStartEndPeriod:function(a,b,c,d){var e="",f=a.find("#"+c).val(),g=a.find("#"+d).val();return CU.Date.diff(g,b)<0&&(e+=Regional.l8964[lan]+b+" "),CU.Date.diff(f,g)<0&&(e+=Regional.l6882[lan]+" "),CU.Date.inThreeMonth(f,g)||(e+=Regional.l6883[lan]+" "),CU.Date.inOneYear(f,g)||(e+=Regional.l8518[lan]+" "),e},validateCommonPeriod:function(a,b,c,d,e,f){var g="",h=a.find("#"+c).val(),i=a.find("#"+d).val();return CU.Date.diff(i,b)<0&&(g+=Regional.l8964[lan]+b+" "),CU.Date.diff(h,i)<0&&(g+=Regional.l6882[lan]+" "),e&&!CU.Date.in_N_month(h,i,e)&&(1==e?g+=Regional.l8930[lan]+" ":3==e&&(g+=Regional.l6883[lan]+" ")),f&&!CU.Date.in_N_month(h,b,12*f)&&1==f&&(g+=Regional.l8518[lan]+" "),g},validateDateInOneYear:function(a,b,c){var d="",e=a.find("#"+c).val();return CU.Date.diff(e,b)<0&&(d+=Regional.l37426[lan]+b+" "),CU.Date.inOneYear(b,c)||(d+=Regional.l37427[lan]+" "),d}},Common.EnterCommon=Common.EnterSelectCommon={ejsPath:{popPayeeQuery:"templates/enterpriseService/transRemit/batrans/popPayeeQuery.ejs",popPayeeQueryTable:"templates/enterpriseService/transRemit/batrans/popPayeeQueryTable.ejs",popPayeeAccountQuery:"templates/enterpriseService/transRemit/batrans/popPayeeAccountQuery.ejs",popPayeeAccountQueryTable:"templates/enterpriseService/transRemit/batrans/popPayeeAccountQueryTable.ejs"},queryPayeeOpenBank:function(a,b,c,d){var e=this;a.el.append(e.ejsPath.popPayeeQuery,b,function(){var f=a.el.find("#enter_bat_payee_query_pop").css({position:"absolute",zIndex:"990"});f.find("#btn_close_1166428,a.close").on("click",function(){f.remove(),Common.LightBox.hide()});var g;if("1"==b.menu){var h=[];h.push({key:"",val:"<span lan='l0092'>"+CU.getDictNameByKey("l0092")+"</span>"}),h=h.concat(Common.ItSelectData.bankList),g=new ITSelect({data:h,appendTo:f.find("#sel_payeebank_1432").empty(),defValue:"",defText:Common.ItSelectData.pleaseSelect,oddCls:"even"})}Common.LightBox.show(),CU.changeLan(CU.setObjAbsCenter(f)),f.find("#btn_query_xwb_1166428").on("click",function(){if("1"==b.menu&&!g.val)return Common.LightBox.showMessage(CU.getDictNameByKey("l51213")),!1;if(!formValid.checkAll(f))return!1;var a={bankName:f.find("#txt_55850_1166426").val()};a.toBankCode="1"==b.menu?g.val:b.toBankCode;var h=new Model("SmeOtherBankInfoQuery",a),i=f.find("#enter_bat_payee_query_data"),j=f.find("#payee_pop_label_1544"),k=f.find("#enter_bat_payee_query_footer");h.findPage=function(a,b){return b&&(this.attributes.params.pageSize=b+""),this.attributes.params.currentIndex=a-1+"",this},Common.postRequest(h.findPage(1,d)).then(function(a){var b=CU.ajaxDataHandle(a);b?(e.ohterHashtable=new Common.Hashtable,$.each(b.list,function(a,b){e.ohterHashtable.add(b.cnapsCode,b)}),i.html(e.ejsPath.popPayeeQueryTable,{list:b.list},function(){var a=function(a){Common.postRequest(h.findPage(a)).then(function(a){var b=CU.ajaxDataHandle(a);b&&b.list&&b.list.length>0&&(e.ohterHashtable=new Common.Hashtable,$.each(b.list,function(a,b){e.ohterHashtable.add(b.cnapsCode,b)}),i.html(e.ejsPath.popPayeeQueryTable,{list:b.list},function(){CU.changeLan(i),g(i)}))})},g=function(a){a.find(".enter-payee_selck").on("click",function(){var a=e.ohterHashtable.item($(this).attr("cnapsCode"));c(a),f.remove(),Common.LightBox.hide()})},l={canvas:k,callbackFn:function(b){a(b)},pageIndex:"1",recordCount:b.recordnumber,pageSize:d,showDownload:!1};g(i);var m=Pager.getInstance();m.init(l),b.list.length>0&&k.show(),i.show(),j.show(),CU.changeLan(f),CU.setObjAbsCenter(f)})):Common.LightBox.hide()})})})},queryPayeeAccount:function(a,b,c,d){var e=this,f={};a.el.append(e.ejsPath.popPayeeAccountQuery,b,function(){var g=a.el.find("#enter_bat_payee_account_query_pop").css({position:"absolute",zIndex:"990"});Common.LightBox.show(),CU.setObjAbsCenter(g);var h="";"VB003"==b.transType?(h="SmeDirRelationListQuery4Trans",f.accountId=b.accountId):(h="SmeTransPayeeQuery",f.bocFlag=["0","1"]),g.find("#btn_searchbutton_1166277").off("click").on("click",function(){if(!formValid.checkAll(g))return!1;var a=g.find("#txt_55839_1166276").val(),i=g.find("#enter_bat_payee_account_data"),j=g.find("#enter_bat_payee_account_footer"),k=new Model(h,f);f.payeeAccName=a,k.findPages=function(a,b){return b&&(this.attributes.params.pageSize=b+""),this.attributes.params.currentIndex=(a-1)*this.attributes.params.pageSize+"",this},Common.postRequest(k.findPages(1,d)).then(function(a){var f=CU.ajaxDataHandle(a);f?i.html(e.ejsPath.popPayeeAccountQueryTable,{list:f.payeeList||f.actDirRelationList,transType:b.transType},function(){e.accountHashtable=new Common.Hashtable,$.each(f.payeeList||f.actDirRelationList,function(a,b){e.accountHashtable.add(b.payeeId||b.payeeAccId,b)});var a=function(a){Common.postRequest(k.findPages(a)).then(function(a){var c=CU.ajaxDataHandle(a);c&&(e.accountHashtable=new Common.Hashtable,$.each(c.payeeList||c.actDirRelationList,function(a,b){e.accountHashtable.add(b.payeeId||b.payeeAccId,b)}),i.html(e.ejsPath.popPayeeAccountQueryTable,{list:c.payeeList||c.actDirRelationList,transType:b.transType},function(){CU.changeLan(i),l(i)}))})},l=function(a){a.find(".payee-account-selck").on("click",function(){var a=e.accountHashtable.item($(this).attr("payeeId"));c(a),g.remove(),Common.LightBox.hide()})},m={canvas:j,callbackFn:function(b){a(b)},pageIndex:"1",recordCount:"SmeDirRelationListQuery4Trans"==h?f.recordNumber:f.totalNum,pageSize:d,showDownload:!1};l(i);var n=Pager.getInstance();n.init(m),f.payeeList&&f.payeeList.length>0||f.actDirRelationList&&f.actDirRelationList.length>0?j.show():j.hide(),g.show(),i.show(),CU.changeLan(CU.setObjAbsCenter(g))}):Common.LightBox.hide()})}),g.find("#div_55851_1166268").on("click","a",function(){Common.triggerAction("EnterPayeeManage"),Common.LightBox.hide()}),g.find("#btn_close_1166266,a.close").on("click",function(){g.remove(),Common.LightBox.hide()}),g.find("#btn_searchbutton_1166277").trigger("click")})}},Common.LightBox.showCallbackMessage=function(){var a=null,b=null,c={};if(0===arguments.length)throw Error("Common.request: 需要参数");for(i=0,len=arguments.length;len>i;i++)switch(i){case 0:c=arguments[i];break;case 1:a=arguments[i];break;case 2:b=arguments[i]}var d={messageLan:"",replaceLan:"",conLan:"l0315",celLan:"l0464",flag:!1},e=c.point;c.replaceLan&&(c.replaceLan=c.replaceLan.join("|")),e.el.append("templates/common/tips.ejs",$.extend(d,c),function(){var d=e.el.find(".bu-pop"),f="#btn_Confirm";c.flag?d.find("#btn_close,.close").on("click",function(){b&&b(),d.remove(),Common.LightBox.hide()}):f="#btn_Confirm,.close",d.find(f).on("click",function(){if(a)a();else{var b=c.nodeId;if(b&&b.length){var e=b.get(0);e&&"INPUT"==e.tagName&&"text"==e.type&&(b.val("").get(0).focus(),c.inwordsId&&c.inwordsId.text("-"))}}d.remove(),Common.LightBox.hide()}),CU.changeLan(d),d.show(),CU.setObjAbsCenter(d),Common.LightBox.show()})};